!function(e){var t={};function i(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(n,s,function(t){return e[t]}.bind(null,s));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=5)}([,,function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t,i){"use strict";i.r(t);var n,s;i(2),i(3),i(4);!function(e){e.FLAG="fas fa-flag",e.MINE="fas fa-bomb"}(n||(n={}));class r{constructor(e,t){this._x=e,this._y=t,this._DOMElement=document.createElement("div"),this.DOMElement.className="cell",this.DOMElement.dataset.x=this.x.toString(),this.DOMElement.dataset.y=this.y.toString(),this._mined=!1,this._revealed=!1,this._flagged=!1,this._mineCount=0}get x(){return this._x}get y(){return this._y}get DOMElement(){return this._DOMElement}get mined(){return this._mined}set mined(e){!0===e?this.DOMElement.classList.add("containsMine"):this.DOMElement.classList.remove("containsMine"),this._mined=e}get flagged(){return this._flagged}set flagged(e){if(!0===e){if(this.revealed||this.flagged)return;this.DOMElement.innerHTML=`<i class="${n.FLAG}"></i>`,this.DOMElement.classList.add("flagged"),this._flagged=!0}else{if(!this.flagged)return;this.DOMElement.innerHTML="",this.DOMElement.classList.remove("flagged"),this._flagged=!1}}get mineCount(){return this._mineCount}set mineCount(e){if(!(e>=0))throw new Error("Invalid mine count value");this._mineCount=e}get revealed(){return this._revealed}reveal(e=!1){return this.revealed?-1:!e&&this.flagged?0:(this.mined?(this.DOMElement.innerHTML=`<i class="${n.MINE}"></i>`,this.DOMElement.classList.add("mined")):(this.mineCount&&(this.DOMElement.innerHTML=this.mineCount.toString()),this.DOMElement.classList.add("revealed")),this._revealed=!0,1)}toggleFlag(){this.flagged?this.flagged=!1:this.flagged=!0}equals(e){return this.x===e.x&&this.y===e.y}isNeighbourOf(e){return Math.abs(this.x-e.x)<=1&&Math.abs(this.y-e.y)<=1}reset(){this.DOMElement.innerHTML="",this.DOMElement.className="cell"}}class l{constructor(e,t,i){this.rowCount=e,this.columnCount=t,this._totalMines=i,this.revealGapTime=50,this.grid=[...Array(this.rowCount)].map((e,t)=>[...Array(this.columnCount)].map((e,i)=>new r(t,i))),this._DOMElement=document.createElement("div"),this.DOMElement.classList.add("minesweeper-grid"),this._mineCells=[],this._unrevealedCellsCount=e*t,this.render()}get DOMElement(){return this._DOMElement}forEachCell(e){this.grid.forEach(t=>{t.forEach(t=>{e(t)})})}render(){this.forEachCell(e=>{this.DOMElement.append(e.DOMElement)}),document.body.append(this.DOMElement)}placeMines(e){let t=0;for(;t<this.totalMines;){const i=Math.floor(Math.random()*this.rowCount),n=Math.floor(Math.random()*this.columnCount),s=this.grid[i][n];s.mined||(s.equals(e)||s.isNeighbourOf(e)||(s.mined=!0,this.mineCells.push(s),t++))}this.updateMineCounts()}getCell(e,t){return this.grid[e][t]}get totalMines(){return this._totalMines}get mineCells(){return this._mineCells}revealAllMines(){this.mineCells.forEach((e,t)=>setTimeout(()=>{1===e.reveal(!0)&&this.unrevealedCellsCount--},t*this.revealGapTime))}get unrevealedCellsCount(){return this._unrevealedCellsCount}set unrevealedCellsCount(e){if(e<0)throw new Error("unrevealedCellsCount cannot be negative");this._unrevealedCellsCount=e}forEachNeighbourhoodCell(e,t){const i=0===e.x?0:e.x-1,n=0===e.y?0:e.y-1,s=e.x===this.rowCount-1?e.x:e.x+1,r=e.y===this.columnCount-1?e.y:e.y+1;for(let l=i;l<=s;l++)for(let i=n;i<=r;i++)l===e.x&&i===e.y||t(this.grid[l][i])}updateMineCounts(){this.forEachCell(e=>{let t=0;this.forEachNeighbourhoodCell(e,e=>e.mined?t++:""),e.mineCount=t})}reset(){this.forEachCell(e=>{e.reset()}),this.mineCells.splice(0)}}!function(e){e[e.CLICK=0]="CLICK",e[e.CONTEXTMENU=1]="CONTEXTMENU"}(s||(s={}));class a{constructor(){this.started=!1,this.isOver=!1}static getInstance(){return this.instance||(this.instance=new a),this.instance}reset(){this.started=!1,this.isOver=!1}}new class{constructor(e){this.grid=new l(e.gridSize.rowCount,e.gridSize.columnCount,e.totalMines),this.gameState=a.getInstance(),this.config()}config(){this.grid.DOMElement.addEventListener("click",e=>{if(!e.target)return;const t=e.target.closest(".cell");t&&this.handleUserInteraction(t,s.CLICK)}),this.grid.DOMElement.addEventListener("contextmenu",e=>{if(e.preventDefault(),!e.target)return;const t=e.target.closest(".cell");t&&this.handleUserInteraction(t,s.CONTEXTMENU)})}handleUserInteraction(e,t){if(!e.dataset.x||!e.dataset.y)return;const i=+e.dataset.x,n=+e.dataset.y;this.gameState.started||this.init(i,n),this.analyseMove({x:i,y:n},t)}init(e,t){const i=this.grid.getCell(e,t);this.grid.placeMines(i),this.gameState.started=!0}checkForSuccess(){(this.grid.mineCells.reduce((e,t)=>e?t.flagged:e,!0)||this.grid.unrevealedCellsCount===this.grid.totalMines)&&(this.gameState.isOver=!0,alert("Congratulations! You Won!"))}analyseMove(e,t){const i=this.grid.getCell(e.x,e.y);if(t===s.CLICK){if(1!==i.reveal())return;if(this.grid.unrevealedCellsCount--,i.mined)return this.gameState.isOver=!0,void this.grid.revealAllMines();i.mineCount||this.grid.forEachNeighbourhoodCell(i,e=>this.analyseMove({x:e.x,y:e.y},s.CLICK))}else t===s.CONTEXTMENU&&i.toggleFlag();this.gameState.isOver||this.checkForSuccess()}reset(){this.grid.reset(),this.gameState.reset()}}({gridSize:{rowCount:10,columnCount:10},totalMines:15})}]);